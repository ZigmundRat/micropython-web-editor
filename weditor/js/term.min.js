/**
 * term.js - an xterm emulator
 * Copyright (c) 2012-2013, Christopher Jeffrey (MIT License)
 * https://github.com/chjj/term.js
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
 * THE SOFTWARE.
 *
 * Originally forked from (with the author's permission):
 *   Fabrice Bellard's javascript vt100 for jslinux:
 *   http://bellard.org/jslinux/
 *   Copyright (c) 2011 Fabrice Bellard
 *   The original design remains. The terminal itself
 *   has been extended to include xterm CSI codes, among
 *   other features.
 */

!function(){"use strict";var window=this,document=this.document;function EventEmitter(){this._events=this._events||{}}function Stream(){EventEmitter.call(this)}EventEmitter.prototype.on=EventEmitter.prototype.addListener=function(type,listener){this._events[type]=this._events[type]||[],this._events[type].push(listener)},EventEmitter.prototype.off=EventEmitter.prototype.removeListener=function(type,listener){if(this._events[type])for(var obj=this._events[type],i=obj.length;i--;)if(obj[i]===listener||obj[i].listener===listener)return void obj.splice(i,1)},EventEmitter.prototype.removeAllListeners=function(type){this._events[type]&&delete this._events[type]},EventEmitter.prototype.once=function(type,listener){function on(){var args=Array.prototype.slice.call(arguments);return this.removeListener(type,on),listener.apply(this,args)}return on.listener=listener,this.on(type,on)},EventEmitter.prototype.emit=function(type){if(this._events[type])for(var args=Array.prototype.slice.call(arguments,1),obj=this._events[type],l=obj.length,i=0;i<l;i++)obj[i].apply(this,args)},EventEmitter.prototype.listeners=function(type){return this._events[type]=this._events[type]||[]},inherits(Stream,EventEmitter),Stream.prototype.pipe=function(dest,options){var ondata,onerror,onend,src=this;function unbind(){src.removeListener("data",ondata),src.removeListener("error",onerror),src.removeListener("end",onend),dest.removeListener("error",onerror),dest.removeListener("close",unbind)}return src.on("data",ondata=function(data){dest.write(data)}),src.on("error",onerror=function(err){if(unbind(),!this.listeners("error").length)throw err}),src.on("end",onend=function(){dest.end(),unbind()}),dest.on("error",onerror),dest.on("close",unbind),dest.emit("pipe",src),dest};var UDK={type:"udk"};function Terminal(options){var self=this;if(!(this instanceof Terminal))return new Terminal(arguments[0],arguments[1],arguments[2]);Stream.call(this),options=(options="number"==typeof options?{cols:arguments[0],rows:arguments[1],handler:arguments[2]}:options)||{},each(keys(Terminal.defaults),function(key){null==options[key]&&(options[key]=Terminal.options[key],Terminal[key]!==Terminal.defaults[key]&&(options[key]=Terminal[key])),self[key]=options[key]}),8===options.colors.length?options.colors=options.colors.concat(Terminal._colors.slice(8)):16===options.colors.length?options.colors=options.colors.concat(Terminal._colors.slice(16)):10===options.colors.length?options.colors=options.colors.slice(0,-2).concat(Terminal._colors.slice(8,-2),options.colors.slice(-2)):18===options.colors.length&&(options.colors=options.colors.slice(0,-2).concat(Terminal._colors.slice(16,-2),options.colors.slice(-2))),this.colors=options.colors,this.options=options,this.parent=options.body||options.parent||(document?document.getElementsByTagName("body")[0]:null),this.cols=options.cols||options.geometry[0],this.rows=options.rows||options.geometry[1],this.setRawMode,this.isTTY=!0,this.isRaw=!0,this.columns=this.cols,this.rows=this.rows,options.handler&&this.on("data",options.handler),this.ybase=0,this.ydisp=0,this.x=0,this.y=0,this.cursorState=0,this.cursorHidden=!1,this.convertEol,this.state=0,this.queue="",this.scrollTop=0,this.scrollBottom=this.rows-1,this.applicationKeypad=!1,this.applicationCursor=!1,this.originMode=!1,this.insertMode=!1,this.wraparoundMode=!1,this.normal=null,this.prefixMode=!1,this.selectMode=!1,this.visualMode=!1,this.searchMode=!1,this.searchDown,this.entry="",this.entryPrefix="Search: ",this._real,this._selected,this._textarea,this.charset=null,this.gcharset=null,this.glevel=0,this.charsets=[null],this.decLocator,this.x10Mouse,this.vt200Mouse,this.vt300Mouse,this.normalMouse,this.mouseEvents,this.sendFocus,this.utfMouse,this.sgrMouse,this.urxvtMouse,this.element,this.children,this.refreshStart,this.refreshEnd,this.savedX,this.savedY,this.savedCols,this.readable=!0,this.writable=!0,this.defAttr=131840,this.curAttr=this.defAttr,this.params=[],this.currentParam=0,this.prefix="",this.postfix="",this.lines=[];for(var i=this.rows;i--;)this.lines.push(this.blankLine());this.tabs,this.setupStops()}function on(el,type,handler,capture){el.addEventListener(type,handler,capture||!1)}function off(el,type,handler,capture){el.removeEventListener(type,handler,capture||!1)}function cancel(ev){return ev.preventDefault&&ev.preventDefault(),ev.returnValue=!1,ev.stopPropagation&&ev.stopPropagation(),!(ev.cancelBubble=!0)}function inherits(child,parent){function f(){this.constructor=child}f.prototype=parent.prototype,child.prototype=new f}inherits(Terminal,Stream),Terminal.tangoColors=["#2e3436","#cc0000","#4e9a06","#c4a000","#3465a4","#75507b","#06989a","#d3d7cf","#555753","#ef2929","#8ae234","#fce94f","#729fcf","#ad7fa8","#34e2e2","#eeeeec"],Terminal.xtermColors=["#000000","#cd0000","#00cd00","#cdcd00","#0000ee","#cd00cd","#00cdcd","#e5e5e5","#7f7f7f","#ff0000","#00ff00","#ffff00","#5c5cff","#ff00ff","#00ffff","#ffffff"],Terminal.colors=function(){for(var colors=Terminal.tangoColors.slice(),r=[0,95,135,175,215,255],i=0;i<216;i++)out(r[i/36%6|0],r[i/6%6|0],r[i%6]);for(i=0;i<24;i++)out(r=8+10*i,r,r);function out(r,g,b){colors.push("#"+hex(r)+hex(g)+hex(b))}function hex(c){return(c=c.toString(16)).length<2?"0"+c:c}return colors}(),Terminal.colors[256]="#000000",Terminal.colors[257]="#f0f0f0",Terminal._colors=Terminal.colors.slice(),Terminal.vcolors=function(){for(var color,out=[],colors=Terminal.colors,i=0;i<256;i++)color=parseInt(colors[i].substring(1),16),out.push([color>>16&255,color>>8&255,255&color]);return out}(),Terminal.defaults={colors:Terminal.colors,convertEol:!1,termName:"xterm",geometry:[80,24],cursorBlink:!0,visualBell:!1,popOnBell:!1,scrollback:1e3,screenKeys:!1,debug:!1,useStyle:!1},Terminal.options={},each(keys(Terminal.defaults),function(key){Terminal[key]=Terminal.defaults[key],Terminal.options[key]=Terminal.defaults[key]}),Terminal.focus=null,Terminal.prototype.focus=function(){Terminal.focus!==this&&(Terminal.focus&&Terminal.focus.blur(),this.sendFocus&&this.send("[I"),this.showCursor(),Terminal.focus=this)},Terminal.prototype.blur=function(){Terminal.focus===this&&(this.cursorState=0,this.refresh(this.y,this.y),this.sendFocus&&this.send("[O"),Terminal.focus=null)},Terminal.prototype.initGlobal=function(){var document=this.document;Terminal._boundDocs=Terminal._boundDocs||[],~function(obj,el){var i=obj.length;for(;i--;)if(obj[i]===el)return i;return-1}(Terminal._boundDocs,document)||(Terminal._boundDocs.push(document),Terminal.bindPaste(document),Terminal.bindKeys(document),Terminal.bindCopy(document),this.isMobile&&this.fixMobile(document),this.useStyle&&Terminal.insertStyle(document,this.colors[256],this.colors[257]))},Terminal.bindPaste=function(document){on(document.defaultView,"paste",function(ev){var term=Terminal.focus;if(term)return ev.clipboardData?term.send(ev.clipboardData.getData("text/plain")):term.context.clipboardData&&term.send(term.context.clipboardData.getData("Text")),term.element.contentEditable="inherit",cancel(ev)})},Terminal.bindKeys=function(document){on(document,"keydown",function(ev){var target;return Terminal.focus&&(target=ev.target||ev.srcElement)&&(target===Terminal.focus.element||target===Terminal.focus.context||target===Terminal.focus.document||target===Terminal.focus.body||target===Terminal._textarea||target===Terminal.focus.parent)?Terminal.focus.keyDown(ev):void 0},!0),on(document,"keypress",function(ev){var target;return Terminal.focus&&(target=ev.target||ev.srcElement)&&!(ev.ctrlKey&&"v"===ev.key||target!==Terminal.focus.element&&target!==Terminal.focus.context&&target!==Terminal.focus.document&&target!==Terminal.focus.body&&target!==Terminal._textarea&&target!==Terminal.focus.parent)?(Terminal.focus.element.contentEditable="inherit",Terminal.focus.keyPress(ev)):void 0},!0),on(document,"mousedown",function(ev){if(Terminal.focus){var el=ev.target||ev.srcElement;if(el){do{if(el===Terminal.focus.element)return}while(el=el.parentNode);Terminal.focus.blur()}}})},Terminal.bindCopy=function(document){on(document.defaultView,"copy",function(ev){var textarea,text,term=Terminal.focus;term&&term._selected&&(textarea=term.getCopyTextarea(),text=term.grabText(term._selected.x1,term._selected.x2,term._selected.y1,term._selected.y2),term.emit("copy",text),textarea.focus(),textarea.textContent=text,textarea.value=text,textarea.setSelectionRange(0,text.length),setTimeout(function(){term.element.focus(),term.focus()},1))})},Terminal.prototype.fixMobile=function(document){var self=this,textarea=document.createElement("textarea");textarea.style.position="absolute",textarea.style.left="-32000px",textarea.style.top="-32000px",textarea.style.width="0px",textarea.style.height="0px",textarea.style.opacity="0",textarea.style.backgroundColor="transparent",textarea.style.borderStyle="none",textarea.style.outlineStyle="none",textarea.autocapitalize="none",textarea.autocorrect="off",document.getElementsByTagName("body")[0].appendChild(textarea),Terminal._textarea=textarea,setTimeout(function(){textarea.focus()},1e3),this.isAndroid&&on(textarea,"change",function(){var value=textarea.textContent||textarea.value;textarea.value="",textarea.textContent="",self.send(value+"\r")})},Terminal.insertStyle=function(document,bg,fg){var head,style=document.getElementById("term-style");style||(head=document.getElementsByTagName("head")[0])&&((style=document.createElement("style")).id="term-style",style.innerHTML=".terminal {\n  float: left;\n  border: "+bg+' solid 5px;\n  font-family: "DejaVu Sans Mono", "Liberation Mono", monospace;\n  font-size: 11px;\n  color: '+fg+";\n  background: "+bg+";\n}\n\n.terminal-cursor {\n  color: "+bg+";\n  background: "+fg+";\n}\n",head.insertBefore(style,head.firstChild))},Terminal.prototype.open=function(parent){var div,body,terminal,line,self=this,i=0;if(this.parent=parent||this.parent,!this.parent)throw new Error("Terminal requires a parent element.");for(this.context=this.parent.ownerDocument.defaultView,this.document=this.parent.ownerDocument,this.body=this.document.getElementsByTagName("body")[0],this.context.navigator&&this.context.navigator.userAgent&&(this.isMac=!!~this.context.navigator.userAgent.indexOf("Mac"),this.isIpad=!!~this.context.navigator.userAgent.indexOf("iPad"),this.isIphone=!!~this.context.navigator.userAgent.indexOf("iPhone"),this.isAndroid=!!~this.context.navigator.userAgent.indexOf("Android"),this.isMobile=this.isIpad||this.isIphone||this.isAndroid,this.isMSIE=!!~this.context.navigator.userAgent.indexOf("MSIE"),this.isFirefox=!!~this.context.navigator.userAgent.indexOf("Firefox")),this.element=this.document.createElement("div"),this.element.className="terminal",this.element.style.outline="none",this.element.setAttribute("tabindex",0),this.element.setAttribute("spellcheck","false"),this.element.style.backgroundColor=this.colors[256],this.element.style.color=this.colors[257],this.children=[];i<this.rows;i++)div=this.document.createElement("div"),this.element.appendChild(div),this.children.push(div);this.parent.appendChild(this.element),this.refresh(0,this.rows-1),"useEvents"in this.options&&!this.options.useEvents||this.initGlobal(),"useFocus"in this.options&&!this.options.useFocus||(this.focus(),this.startBlink(),on(this.element,"focus",function(){self.focus(),self.isMobile&&Terminal._textarea.focus()}),on(this.element,"mousedown",function(){self.focus()}),on(this.element,"mousedown",function(ev){ev=null!=ev.button?+ev.button:null!=ev.which?ev.which-1:null;1!==(ev=self.isMSIE?1===ev?0:4===ev?1:ev:ev)&&2!==ev?self.element.contentEditable="inherit":(self.element.contentEditable="true",self.isFirefox&&window.getSelection().collapse(self.element,0),self.isFirefox||setTimeout(function(){self.element.contentEditable="inherit"},1))},!0)),"useMouse"in this.options&&!this.options.useMouse||this.bindMouse(),"useFocus"in this.options&&!this.options.useFocus||setTimeout(function(){self.element.focus()},100),null==Terminal.brokenBold&&(Terminal.brokenBold=(parent=this.document,body=parent.getElementsByTagName("body")[0],(terminal=parent.createElement("div")).className="terminal",line=parent.createElement("div"),(parent=parent.createElement("span")).innerHTML="hello world",line.appendChild(parent),terminal.appendChild(line),body.appendChild(terminal),line=parent.scrollWidth,parent.style.fontWeight="bold",parent=parent.scrollWidth,body.removeChild(terminal),line!==parent)),this.emit("open")},Terminal.prototype.setRawMode=function(value){this.isRaw=!!value},Terminal.prototype.bindMouse=function(){var el=this.element,self=this,pressed=32,wheelEvent="onmousewheel"in this.context?"mousewheel":"DOMMouseScroll";function sendButton(ev){var button=function(ev){var button,meta,ctrl,shift;switch(ev.type){case"mousedown":button=null!=ev.button?+ev.button:null!=ev.which?ev.which-1:null,self.isMSIE&&(button=1===button?0:4===button?1:button);break;case"mouseup":button=3;break;case"DOMMouseScroll":button=ev.detail<0?64:65;break;case"mousewheel":button=0<ev.wheelDeltaY?64:65}shift=ev.shiftKey?4:0,meta=ev.metaKey?8:0,ctrl=ev.ctrlKey?16:0,shift=shift|meta|ctrl,self.vt200Mouse?shift&=ctrl:self.normalMouse||(shift=0);return button=32+(shift<<2)+button}(ev),pos=getCoords(ev);if(pos)switch(sendEvent(button,pos),ev.type){case"mousedown":pressed=button;break;case"mouseup":pressed=32}}function sendMove(ev){var button=pressed,ev=getCoords(ev);ev&&sendEvent(button+=32,ev)}function encode(data,ch){if(self.utfMouse){if(2047===ch)return data.push(0);ch<127?data.push(ch):(data.push(192|(ch=2047<ch?2047:ch)>>6),data.push(128|63&ch))}else{if(255===ch)return data.push(0);data.push(ch=127<ch?127:ch)}}function sendEvent(button,pos){if(self.vt300Mouse){button&=3,pos.x-=32,pos.y-=32;var data="[24";if(0===button)data+="1";else if(1===button)data+="3";else if(2===button)data+="5";else{if(3===button)return;data+="0"}data+="~["+pos.x+","+pos.y+"]\r",self.send(data)}else self.decLocator?(button&=3,pos.x-=32,pos.y-=32,0===button?button=2:1===button?button=4:2===button?button=6:3===button&&(button=3),self.send("["+button+";"+(3===button?4:0)+";"+pos.y+";"+pos.x+";"+(pos.page||0)+"&w")):self.urxvtMouse?(pos.x-=32,pos.y-=32,pos.x++,pos.y++,self.send("["+button+";"+pos.x+";"+pos.y+"M")):self.sgrMouse?(pos.x-=32,pos.y-=32,self.send("[<"+(3==(3&button)?-4&button:button)+";"+pos.x+";"+pos.y+(3==(3&button)?"m":"M"))):(encode(data=[],button),encode(data,pos.x),encode(data,pos.y),self.send("[M"+String.fromCharCode.apply(String,data)))}function getCoords(ev){var x,y,w,h,el;if(null!=ev.pageX){for(x=ev.pageX,y=ev.pageY,el=self.element;el&&el!==self.document.documentElement;)x-=el.offsetLeft,y-=el.offsetTop,el="offsetParent"in el?el.offsetParent:el.parentNode;return w=self.element.clientWidth,h=self.element.clientHeight,x=Math.round(x/w*self.cols),y=Math.round(y/h*self.rows),(x=x<0?0:x)>self.cols&&(x=self.cols),(y=y<0?0:y)>self.rows&&(y=self.rows),{x:x+=32,y:y+=32,type:ev.type===wheelEvent?"mousewheel":ev.type}}}on(el,"mousedown",function(ev){if(self.mouseEvents)return sendButton(ev),self.focus(),self.normalMouse&&on(self.document,"mousemove",sendMove),self.x10Mouse||on(self.document,"mouseup",function up(ev){return sendButton(ev),self.normalMouse&&off(self.document,"mousemove",sendMove),off(self.document,"mouseup",up),cancel(ev)}),cancel(ev)}),on(el,wheelEvent,function(ev){if(self.mouseEvents&&!(self.x10Mouse||self.vt300Mouse||self.decLocator))return sendButton(ev),cancel(ev)}),on(el,wheelEvent,function(ev){if(!self.mouseEvents&&!self.applicationKeypad)return"DOMMouseScroll"===ev.type?self.scrollDisp(ev.detail<0?-5:5):self.scrollDisp(0<ev.wheelDeltaY?-5:5),cancel(ev)})},Terminal.prototype.close=Terminal.prototype.destroySoon=Terminal.prototype.destroy=function(){this.destroyed||(this._blink&&(clearInterval(this._blink),delete this._blink),this.readable=!1,this.writable=!1,this.destroyed=!0,this._events={},this.handler=function(){},this.write=function(){},this.end=function(){},this.element.parentNode&&this.element.parentNode.removeChild(this.element),this.emit("end"),this.emit("close"),this.emit("finish"),this.emit("destroy"))},Terminal.prototype.refresh=function(start,end){var x,y,i,line,out,ch,width,data,attr,bg,fg,flags,row,parent;for(end-start>=this.rows/2&&(parent=this.element.parentNode)&&parent.removeChild(this.element),width=this.cols,y=start,end>=this.lines.length&&(this.log("`end` is too large. Most likely a bad CSR."),end=this.lines.length-1);y<=end;y++){for(row=y+this.ydisp,line=this.lines[row],out="",x=y!==this.y||!this.cursorState||this.ydisp!==this.ybase&&!this.selectMode||this.cursorHidden?-1:this.x,attr=this.defAttr,i=0;i<width;i++){switch(data=line[i][0],ch=line[i][1],(data=i===x?-1:data)!==attr&&(attr!==this.defAttr&&(out+="</span>"),data!==this.defAttr&&(-1===data?out+='<span class="reverse-video terminal-cursor">':(out+='<span style="',bg=511&data,fg=data>>9&511,1&(flags=data>>18)&&(Terminal.brokenBold||(out+="font-weight:bold;"),fg<8&&(fg+=8)),2&flags&&(out+="text-decoration:underline;"),4&flags&&(2&flags?(out=out.slice(0,-1),out+=" blink;"):out+="text-decoration:blink;"),8&flags&&(bg=data>>9&511,fg=511&data,1&flags&&fg<8&&(fg+=8)),16&flags&&(out+="visibility:hidden;"),256!==bg&&(out+="background-color:"+this.colors[bg]+";"),257!==fg&&(out+="color:"+this.colors[fg]+";"),out+='">'))),ch){case"&":out+="&amp;";break;case"<":out+="&lt;";break;case">":out+="&gt;";break;default:ch<=" "?out+="&nbsp;":(isWide(ch)&&i++,out+=ch)}attr=data}attr!==this.defAttr&&(out+="</span>"),this.children[y].innerHTML=out}parent&&parent.appendChild(this.element)},Terminal.prototype._cursorBlink=function(){Terminal.focus===this&&(this.cursorState^=1,this.refresh(this.y,this.y))},Terminal.prototype.showCursor=function(){this.cursorState||(this.cursorState=1,this.refresh(this.y,this.y))},Terminal.prototype.startBlink=function(){var self;this.cursorBlink&&((self=this)._blinker=function(){self._cursorBlink()},this._blink=setInterval(this._blinker,500))},Terminal.prototype.refreshBlink=function(){this.cursorBlink&&this._blink&&(clearInterval(this._blink),this._blink=setInterval(this._blinker,500))},Terminal.prototype.scroll=function(){var row;++this.ybase===this.scrollback&&(this.ybase=this.ybase/2|0,this.lines=this.lines.slice(1-(this.ybase+this.rows))),this.ydisp=this.ybase,row=this.ybase+this.rows-1,(row-=this.rows-1-this.scrollBottom)===this.lines.length?this.lines.push(this.blankLine()):this.lines.splice(row,0,this.blankLine()),0!==this.scrollTop&&(0!==this.ybase&&(this.ybase--,this.ydisp=this.ybase),this.lines.splice(this.ybase+this.scrollTop,1)),this.updateRange(this.scrollTop),this.updateRange(this.scrollBottom)},Terminal.prototype.scrollDisp=function(disp){this.ydisp+=disp,this.ydisp>this.ybase?this.ydisp=this.ybase:this.ydisp<0&&(this.ydisp=0),this.refresh(0,this.rows-1)},Terminal.prototype.write=function(data){var j,cs,ch,l=data.length,i=0;for(this.refreshStart=this.y,this.refreshEnd=this.y,this.ybase!==this.ydisp&&(this.ydisp=this.ybase,this.maxRange());i<l;i++,this.lch=ch)switch(ch=data[i],this.state){case 0:switch(ch){case"":this.bell();break;case"\n":case"\v":case"\f":this.convertEol&&(this.x=0),this.y++,this.y>this.scrollBottom&&(this.y--,this.scroll());break;case"\r":this.x=0;break;case"\b":0<this.x&&this.x--;break;case"\t":this.x=this.nextStop();break;case"":this.setgLevel(1);break;case"":this.setgLevel(0);break;case"":this.state=1;break;default:if(" "<=ch&&(this.charset&&this.charset[ch]&&(ch=this.charset[ch]),this.x>=this.cols&&(this.x=0,this.y++,this.y>this.scrollBottom&&(this.y--,this.scroll())),this.lines[this.y+this.ybase][this.x]=[this.curAttr,ch],this.x++,this.updateRange(this.y),isWide(ch))){if(j=this.y+this.ybase,this.cols<2||this.x>=this.cols){this.lines[j][this.x-1]=[this.curAttr," "];break}this.lines[j][this.x]=[this.curAttr," "],this.x++}}break;case 1:switch(ch){case"[":this.params=[],this.currentParam=0,this.state=2;break;case"]":this.params=[],this.currentParam=0,this.state=3;break;case"P":this.params=[],this.prefix="",this.currentParam="",this.state=5;break;case"_":case"^":this.state=6;break;case"c":this.reset();break;case"E":this.x=0;case"D":this.index();break;case"M":this.reverseIndex();break;case"%":this.setgLevel(0),this.setgCharset(0,Terminal.charsets.US),this.state=0,i++;break;case"(":case")":case"*":case"+":case"-":case".":switch(ch){case"(":this.gcharset=0;break;case")":this.gcharset=1;break;case"*":this.gcharset=2;break;case"+":this.gcharset=3;break;case"-":this.gcharset=1;break;case".":this.gcharset=2}this.state=4;break;case"/":this.gcharset=3,this.state=4,i--;break;case"N":case"O":break;case"n":this.setgLevel(2);break;case"o":case"|":this.setgLevel(3);break;case"}":this.setgLevel(2);break;case"~":this.setgLevel(1);break;case"7":this.saveCursor(),this.state=0;break;case"8":this.restoreCursor(),this.state=0;break;case"#":this.state=0,i++;break;case"H":this.tabSet();break;case"=":this.log("Serial port requested application keypad."),this.applicationKeypad=!0,this.state=0;break;case">":this.log("Switching back to normal keypad."),this.applicationKeypad=!1,this.state=0;break;default:this.state=0,this.error("Unknown ESC control: %s.",ch)}break;case 4:switch(ch){case"0":cs=Terminal.charsets.SCLD;break;case"A":cs=Terminal.charsets.UK;break;case"B":cs=Terminal.charsets.US;break;case"4":cs=Terminal.charsets.Dutch;break;case"C":case"5":cs=Terminal.charsets.Finnish;break;case"R":cs=Terminal.charsets.French;break;case"Q":cs=Terminal.charsets.FrenchCanadian;break;case"K":cs=Terminal.charsets.German;break;case"Y":cs=Terminal.charsets.Italian;break;case"E":case"6":cs=Terminal.charsets.NorwegianDanish;break;case"Z":cs=Terminal.charsets.Spanish;break;case"H":case"7":cs=Terminal.charsets.Swedish;break;case"=":cs=Terminal.charsets.Swiss;break;case"/":cs=Terminal.charsets.ISOLatin,i++;break;default:cs=Terminal.charsets.US}this.setgCharset(this.gcharset,cs),this.gcharset=null,this.state=0;break;case 3:if(""===this.lch&&"\\"===ch||""===ch){switch(""===this.lch&&("string"==typeof this.currentParam?this.currentParam=this.currentParam.slice(0,-1):"number"==typeof this.currentParam&&(this.currentParam=(this.currentParam-("".charCodeAt(0)-48))/10)),this.params.push(this.currentParam),this.params[0]){case 0:case 1:case 2:this.params[1]&&(this.title=this.params[1],this.handleTitle(this.title))}this.params=[],this.currentParam=0,this.state=0}else this.params.length?this.currentParam+=ch:"0"<=ch&&ch<="9"?this.currentParam=10*this.currentParam+ch.charCodeAt(0)-48:";"===ch&&(this.params.push(this.currentParam),this.currentParam="");break;case 2:if("?"===ch||">"===ch||"!"===ch)this.prefix=ch;else if("0"<=ch&&ch<="9")this.currentParam=10*this.currentParam+ch.charCodeAt(0)-48;else if("$"===ch||'"'===ch||" "===ch||"'"===ch)this.postfix=ch;else if(this.params.push(this.currentParam),this.currentParam=0,";"!==ch){switch(this.state=0,ch){case"A":this.cursorUp(this.params);break;case"B":this.cursorDown(this.params);break;case"C":this.cursorForward(this.params);break;case"D":this.cursorBackward(this.params);break;case"H":this.cursorPos(this.params);break;case"J":this.eraseInDisplay(this.params);break;case"K":this.eraseInLine(this.params);break;case"m":this.prefix||this.charAttributes(this.params);break;case"n":this.prefix||this.deviceStatus(this.params);break;case"@":this.insertChars(this.params);break;case"E":this.cursorNextLine(this.params);break;case"F":this.cursorPrecedingLine(this.params);break;case"G":this.cursorCharAbsolute(this.params);break;case"L":this.insertLines(this.params);break;case"M":this.deleteLines(this.params);break;case"P":this.deleteChars(this.params);break;case"X":this.eraseChars(this.params);break;case"`":this.charPosAbsolute(this.params);break;case"a":this.HPositionRelative(this.params);break;case"c":this.sendDeviceAttributes(this.params);break;case"d":this.linePosAbsolute(this.params);break;case"e":this.VPositionRelative(this.params);break;case"f":this.HVPosition(this.params);break;case"h":this.setMode(this.params);break;case"l":this.resetMode(this.params);break;case"r":this.setScrollRegion(this.params);break;case"s":this.saveCursor(this.params);break;case"u":this.restoreCursor(this.params);break;case"I":this.cursorForwardTab(this.params);break;case"S":this.scrollUp(this.params);break;case"T":this.params.length<2&&!this.prefix&&this.scrollDown(this.params);break;case"Z":this.cursorBackwardTab(this.params);break;case"b":this.repeatPrecedingCharacter(this.params);break;case"g":this.tabClear(this.params);break;case"p":"!"===this.prefix&&this.softReset(this.params);break;default:this.error("Unknown CSI code: %s.",ch)}this.prefix="",this.postfix=""}break;case 5:if(""===this.lch&&"\\"===ch||""===ch){if("tmux;"===this.prefix&&""===ch){this.currentParam+=ch;continue}""===this.lch&&("string"==typeof this.currentParam?this.currentParam=this.currentParam.slice(0,-1):"number"==typeof this.currentParam&&(this.currentParam=(this.currentParam-("".charCodeAt(0)-48))/10)),this.params.push(this.currentParam);var pt=this.params[this.params.length-1];switch(this.prefix){case UDK:this.emit("udk",{clearAll:0===this.params[0],eraseBelow:1===this.params[0],lockKeys:0===this.params[1],dontLockKeys:1===this.params[1],keyList:(this.params[2]+"").split(";").map(function(part){return{keyCode:(part=part.split("/"))[0],hexKeyValue:part[1]}})});break;case"$q":var valid=0;switch(pt){case'"q':pt='0"q',valid=1;break;case'"p':pt='61;0"p',valid=1;break;case"r":pt=this.scrollTop+1+";"+(this.scrollBottom+1)+"r",valid=1;break;case"m":valid=0;break;default:this.error("Unknown DCS Pt: %s.",pt),valid=0}this.send("P"+valid+"$r"+pt+"\\");break;case"+p":this.emit("set terminfo",{name:this.params[0]});break;case"+q":valid=!1;this.send("P"+ +valid+"+r"+pt+"\\");break;case"tmux;":this.emit("passthrough",pt);break;default:this.error("Unknown DCS prefix: %s.",pt)}this.currentParam=0,this.prefix="",this.state=0}else this.currentParam+=ch,this.prefix||(/^\d*;\d*\|/.test(this.currentParam)?(this.prefix=UDK,this.params=this.currentParam.split(/[;|]/).map(function(n){return n.length?+n:0}).slice(0,-1),this.currentParam=""):(/^[$+][a-zA-Z]/.test(this.currentParam)||/^\w+;\x1b/.test(this.currentParam))&&(this.prefix=this.currentParam,this.currentParam=""));break;case 6:(""===this.lch&&"\\"===ch||""===ch)&&(this.state=0)}return this.updateRange(this.y),this.refresh(this.refreshStart,this.refreshEnd),!0},Terminal.prototype.writeln=function(data){return this.write(data+"\r\n")},Terminal.prototype.end=function(data){var ret=!0;return data&&(ret=this.write(data)),this.destroySoon(),ret},Terminal.prototype.resume=function(){},Terminal.prototype.pause=function(){},Terminal.prototype.keyDown=function(ev){var key,self=this;switch(ev.keyCode){case 8:ev.altKey?key="":key=ev.shiftKey?"\b":"";break;case 9:ev.shiftKey?key="[Z":key="\t";break;case 13:key="\r";break;case 27:key="";break;case 32:key=" ";break;case 37:this.applicationCursor?key="OD":key=ev.ctrlKey?"[5D":"[D";break;case 39:this.applicationCursor?key="OC":key=ev.ctrlKey?"[5C":"[C";break;case 38:if(this.applicationCursor)key="OA";else{if(ev.ctrlKey)return this.scrollDisp(-1),cancel(ev);key="[A"}break;case 40:if(this.applicationCursor)key="OB";else{if(ev.ctrlKey)return this.scrollDisp(1),cancel(ev);key="[B"}break;case 46:key="[3~";break;case 45:key="[2~";break;case 36:this.applicationKeypad?key="OH":key="OH";break;case 35:this.applicationKeypad?key="OF":key="OF";break;case 33:if(ev.shiftKey)return this.scrollDisp(-(this.rows-1)),cancel(ev);key="[5~";break;case 34:if(ev.shiftKey)return this.scrollDisp(this.rows-1),cancel(ev);key="[6~";break;case 112:key="OP";break;case 113:key="OQ";break;case 114:key="OR";break;case 115:key="OS";break;case 116:key="[15~";break;case 117:key="[17~";break;case 118:key="[18~";break;case 119:key="[19~";break;case 120:key="[20~";break;case 121:key="[21~";break;case 122:key="[23~";break;case 123:key="[24~";break;default:if(ev.ctrlKey)if(65<=ev.keyCode&&ev.keyCode<=90){if(this.screenKeys&&!this.prefixMode&&!this.selectMode&&65===ev.keyCode)return this.enterPrefix(),cancel(ev);if(this.prefixMode&&86===ev.keyCode)return this.leavePrefix(),void(Terminal.focus.element.contentEditable="true");if((this.prefixMode||this.selectMode)&&67===ev.keyCode)return void(this.visualMode&&setTimeout(function(){self.leaveVisual()},1));key=String.fromCharCode(ev.keyCode-64)}else 32===ev.keyCode?key=String.fromCharCode(0):51<=ev.keyCode&&ev.keyCode<=55?key=String.fromCharCode(ev.keyCode-51+27):56===ev.keyCode?key=String.fromCharCode(127):219===ev.keyCode?key=String.fromCharCode(27):221===ev.keyCode&&(key=String.fromCharCode(29));else ev.altKey&&(65<=ev.keyCode&&ev.keyCode<=90?key=""+String.fromCharCode(ev.keyCode+32):192===ev.keyCode?key="`":48<=ev.keyCode&&ev.keyCode<=57&&(key=""+(ev.keyCode-48)))}return!key||(this.prefixMode?this.leavePrefix():this.selectMode?this.keySelect(ev,key):(this.emit("keydown",ev),this.emit("key",key,ev),this.showCursor(),this.handler(key)),cancel(ev))},Terminal.prototype.setgLevel=function(g){this.glevel=g,this.charset=this.charsets[g]},Terminal.prototype.setgCharset=function(g,charset){this.charsets[g]=charset,this.glevel===g&&(this.charset=charset)},Terminal.prototype.keyPress=function(ev){var key;if(cancel(ev),ev.charCode)key=ev.charCode;else if(null==ev.which)key=ev.keyCode;else{if(0===ev.which||0===ev.charCode)return!1;key=ev.which}return!key||ev.ctrlKey||ev.altKey||ev.metaKey||(key=String.fromCharCode(key),this.prefixMode?(this.leavePrefix(),this.keyPrefix(ev,key)):this.selectMode?this.keySelect(ev,key):(this.emit("keypress",key,ev),this.emit("key",key,ev),this.showCursor(),this.handler(key))),!1},Terminal.prototype.send=function(data){var self=this;this.queue||setTimeout(function(){self.handler(self.queue),self.queue=""},1),this.queue+=data},Terminal.prototype.bell=function(){var self;this.emit("bell"),this.visualBell&&((self=this).element.style.borderColor="white",setTimeout(function(){self.element.style.borderColor=""},10),this.popOnBell&&this.focus())},Terminal.prototype.log=function(){var args;this.debug&&this.context.console&&this.context.console.log&&(args=Array.prototype.slice.call(arguments),this.context.console.log.apply(this.context.console,args))},Terminal.prototype.error=function(){var args;this.debug&&this.context.console&&this.context.console.error&&(args=Array.prototype.slice.call(arguments),this.context.console.error.apply(this.context.console,args))},Terminal.prototype.resize=function(x,y){var line,el,i,j,ch;if(y<1&&(y=1),(j=this.cols)<(x=x<1?1:x))for(ch=[this.defAttr," "],i=this.lines.length;i--;)for(;this.lines[i].length<x;)this.lines[i].push(ch);else if(x<j)for(i=this.lines.length;i--;)for(;this.lines[i].length>x;)this.lines[i].pop();if(this.setupStops(j),this.cols=x,this.columns=x,(j=this.rows)<y)for(el=this.element;j++<y;)this.lines.length<y+this.ybase&&this.lines.push(this.blankLine()),this.children.length<y&&(line=this.document.createElement("div"),el.appendChild(line),this.children.push(line));else if(y<j)for(;j-- >y;)this.lines.length>y+this.ybase&&this.lines.pop(),this.children.length>y&&(el=this.children.pop())&&el.parentNode.removeChild(el);this.rows=y,this.y>=y&&(this.y=y-1),this.x>=x&&(this.x=x-1),this.scrollTop=0,this.scrollBottom=y-1,this.refresh(0,this.rows-1),this.normal=null,this.emit("resize")},Terminal.prototype.updateRange=function(y){y<this.refreshStart&&(this.refreshStart=y),y>this.refreshEnd&&(this.refreshEnd=y)},Terminal.prototype.maxRange=function(){this.refreshStart=0,this.refreshEnd=this.rows-1},Terminal.prototype.setupStops=function(i){for(null!=i?this.tabs[i]||(i=this.prevStop(i)):(this.tabs={},i=0);i<this.cols;i+=8)this.tabs[i]=!0},Terminal.prototype.prevStop=function(x){for(null==x&&(x=this.x);!this.tabs[--x]&&0<x;);return x>=this.cols?this.cols-1:x<0?0:x},Terminal.prototype.nextStop=function(x){for(null==x&&(x=this.x);!this.tabs[++x]&&x<this.cols;);return x>=this.cols?this.cols-1:x<0?0:x},Terminal.prototype.eraseAttr=function(){return-512&this.defAttr|511&this.curAttr},Terminal.prototype.eraseRight=function(x,y){for(var line=this.lines[this.ybase+y],ch=[this.eraseAttr()," "];x<this.cols;x++)line[x]=ch;this.updateRange(y)},Terminal.prototype.eraseLeft=function(x,y){var line=this.lines[this.ybase+y],ch=[this.eraseAttr()," "];for(x++;x--;)line[x]=ch;this.updateRange(y)},Terminal.prototype.eraseLine=function(y){this.eraseRight(0,y)},Terminal.prototype.blankLine=function(cur){for(var ch=[cur?this.eraseAttr():this.defAttr," "],line=[],i=0;i<this.cols;i++)line[i]=ch;return line},Terminal.prototype.ch=function(cur){return cur?[this.eraseAttr()," "]:[this.defAttr," "]},Terminal.prototype.is=function(term){return 0===(this.termName+"").indexOf(term)},Terminal.prototype.handler=function(data){this.emit("data",data)},Terminal.prototype.handleTitle=function(title){this.emit("title",title)},Terminal.prototype.index=function(){this.y++,this.y>this.scrollBottom&&(this.y--,this.scroll()),this.state=0},Terminal.prototype.reverseIndex=function(){var j;this.y--,this.y<this.scrollTop&&(this.y++,this.lines.splice(this.y+this.ybase,0,this.blankLine(!0)),j=this.rows-1-this.scrollBottom,this.lines.splice(this.rows-1+this.ybase-j+1,1),this.updateRange(this.scrollTop),this.updateRange(this.scrollBottom)),this.state=0},Terminal.prototype.reset=function(){this.options.rows=this.rows,this.options.cols=this.cols,Terminal.call(this,this.options),this.refresh(0,this.rows-1)},Terminal.prototype.tabSet=function(){this.tabs[this.x]=!0,this.state=0},Terminal.prototype.cursorUp=function(params){params=params[0];this.y-=params=params<1?1:params,this.y<0&&(this.y=0)},Terminal.prototype.cursorDown=function(params){params=params[0];this.y+=params=params<1?1:params,this.y>=this.rows&&(this.y=this.rows-1)},Terminal.prototype.cursorForward=function(params){params=params[0];this.x+=params=params<1?1:params,this.x>=this.cols&&(this.x=this.cols-1)},Terminal.prototype.cursorBackward=function(params){params=params[0];this.x-=params=params<1?1:params,this.x<0&&(this.x=0)},Terminal.prototype.cursorPos=function(params){var row=params[0]-1,params=2<=params.length?params[1]-1:0;row<0?row=0:row>=this.rows&&(row=this.rows-1),params<0?params=0:params>=this.cols&&(params=this.cols-1),this.x=params,this.y=row},Terminal.prototype.eraseInDisplay=function(params){var j;switch(params[0]){case 0:for(this.eraseRight(this.x,this.y),j=this.y+1;j<this.rows;j++)this.eraseLine(j);break;case 1:for(this.eraseLeft(this.x,this.y),j=this.y;j--;)this.eraseLine(j);break;case 2:for(j=this.rows;j--;)this.eraseLine(j)}},Terminal.prototype.eraseInLine=function(params){switch(params[0]){case 0:this.eraseRight(this.x,this.y);break;case 1:this.eraseLeft(this.x,this.y);break;case 2:this.eraseLine(this.y)}},Terminal.prototype.charAttributes=function(params){if(1===params.length&&0===params[0])this.curAttr=this.defAttr;else{for(var p,l=params.length,i=0,flags=this.curAttr>>18,fg=this.curAttr>>9&511,bg=511&this.curAttr;i<l;i++)30<=(p=params[i])&&p<=37?fg=p-30:40<=p&&p<=47?bg=p-40:90<=p&&p<=97?fg=(p+=8)-90:100<=p&&p<=107?bg=(p+=8)-100:0===p?(flags=this.defAttr>>18,fg=this.defAttr>>9&511,bg=511&this.defAttr):1===p?flags|=1:4===p?flags|=2:5===p?flags|=4:7===p?flags|=8:8===p?flags|=16:22===p?flags&=-2:24===p?flags&=-3:25===p?flags&=-5:27===p?flags&=-9:28===p?flags&=-17:39===p?fg=this.defAttr>>9&511:49===p?bg=511&this.defAttr:38===p?2===params[i+1]?(-1===(fg=matchColor(255&params[i+=2],255&params[i+1],255&params[i+2]))&&(fg=511),i+=2):5===params[i+1]&&(fg=p=255&params[i+=2]):48===p?2===params[i+1]?(-1===(bg=matchColor(255&params[i+=2],255&params[i+1],255&params[i+2]))&&(bg=511),i+=2):5===params[i+1]&&(bg=p=255&params[i+=2]):100===p?(fg=this.defAttr>>9&511,bg=511&this.defAttr):this.error("Unknown SGR attribute: %d.",p);this.curAttr=flags<<18|fg<<9|bg}},Terminal.prototype.deviceStatus=function(params){if(this.prefix)"?"===this.prefix&&6===params[0]&&this.send("[?"+(this.y+1)+";"+(this.x+1)+"R");else switch(params[0]){case 5:this.send("[0n");break;case 6:this.send("["+(this.y+1)+";"+(this.x+1)+"R")}},Terminal.prototype.insertChars=function(params){var row,j,ch,param=params[0];for(param<1&&(param=1),row=this.y+this.ybase,j=this.x,ch=[this.eraseAttr()," "];param--&&j<this.cols;)this.lines[row].splice(j++,0,ch),this.lines[row].pop()},Terminal.prototype.cursorNextLine=function(params){params=params[0];this.y+=params=params<1?1:params,this.y>=this.rows&&(this.y=this.rows-1),this.x=0},Terminal.prototype.cursorPrecedingLine=function(params){params=params[0];this.y-=params=params<1?1:params,this.y<0&&(this.y=0),this.x=0},Terminal.prototype.cursorCharAbsolute=function(params){params=params[0];this.x=(params=params<1?1:params)-1},Terminal.prototype.insertLines=function(params){var row,j,param=params[0];for(param<1&&(param=1),row=this.y+this.ybase,j=this.rows-1-this.scrollBottom,j=this.rows-1+this.ybase-j+1;param--;)this.lines.splice(row,0,this.blankLine(!0)),this.lines.splice(j,1);this.updateRange(this.y),this.updateRange(this.scrollBottom)},Terminal.prototype.deleteLines=function(params){var row,j,param=params[0];for(param<1&&(param=1),row=this.y+this.ybase,j=this.rows-1-this.scrollBottom,j=this.rows-1+this.ybase-j;param--;)this.lines.splice(1+j,0,this.blankLine(!0)),this.lines.splice(row,1);this.updateRange(this.y),this.updateRange(this.scrollBottom)},Terminal.prototype.deleteChars=function(params){var row,ch,param=params[0];for(param<1&&(param=1),row=this.y+this.ybase,ch=[this.eraseAttr()," "];param--;)this.lines[row].splice(this.x,1),this.lines[row].push(ch)},Terminal.prototype.eraseChars=function(params){var row,j,ch,param=params[0];for(param<1&&(param=1),row=this.y+this.ybase,j=this.x,ch=[this.eraseAttr()," "];param--&&j<this.cols;)this.lines[row][j++]=ch},Terminal.prototype.charPosAbsolute=function(params){params=params[0];this.x=(params=params<1?1:params)-1,this.x>=this.cols&&(this.x=this.cols-1)},Terminal.prototype.HPositionRelative=function(params){params=params[0];this.x+=params=params<1?1:params,this.x>=this.cols&&(this.x=this.cols-1)},Terminal.prototype.sendDeviceAttributes=function(params){0<params[0]||(this.prefix?">"===this.prefix&&(this.is("xterm")?this.send("[>0;276;0c"):this.is("rxvt-unicode")?this.send("[>85;95;0c"):this.is("linux")?this.send(params[0]+"c"):this.is("screen")&&this.send("[>83;40003;0c")):this.is("xterm")||this.is("rxvt-unicode")||this.is("screen")?this.send("[?1;2c"):this.is("linux")&&this.send("[?6c"))},Terminal.prototype.linePosAbsolute=function(params){params=params[0];this.y=(params=params<1?1:params)-1,this.y>=this.rows&&(this.y=this.rows-1)},Terminal.prototype.VPositionRelative=function(params){params=params[0];this.y+=params=params<1?1:params,this.y>=this.rows&&(this.y=this.rows-1)},Terminal.prototype.HVPosition=function(params){params[0]<1&&(params[0]=1),params[1]<1&&(params[1]=1),this.y=params[0]-1,this.y>=this.rows&&(this.y=this.rows-1),this.x=params[1]-1,this.x>=this.cols&&(this.x=this.cols-1)},Terminal.prototype.setMode=function(params){if("object"==typeof params)for(var l=params.length,i=0;i<l;i++)this.setMode(params[i]);else if(this.prefix){if("?"===this.prefix)switch(params){case 1:this.applicationCursor=!0;break;case 2:this.setgCharset(0,Terminal.charsets.US),this.setgCharset(1,Terminal.charsets.US),this.setgCharset(2,Terminal.charsets.US),this.setgCharset(3,Terminal.charsets.US);break;case 3:this.savedCols=this.cols,this.resize(132,this.rows);break;case 6:this.originMode=!0;break;case 7:this.wraparoundMode=!0;break;case 12:break;case 66:this.log("Serial port requested application keypad."),this.applicationKeypad=!0;break;case 9:case 1e3:case 1002:case 1003:this.x10Mouse=9===params,this.vt200Mouse=1e3===params,this.normalMouse=1e3<params,this.mouseEvents=!0,this.element.style.cursor="default",this.log("Binding to mouse events.");break;case 1004:this.sendFocus=!0;break;case 1005:this.utfMouse=!0;break;case 1006:this.sgrMouse=!0;break;case 1015:this.urxvtMouse=!0;break;case 25:this.cursorHidden=!1;break;case 1049:case 47:case 1047:var normal;this.normal||(normal={lines:this.lines,ybase:this.ybase,ydisp:this.ydisp,x:this.x,y:this.y,scrollTop:this.scrollTop,scrollBottom:this.scrollBottom,tabs:this.tabs},this.reset(),this.normal=normal,this.showCursor())}}else 4===params&&(this.insertMode=!0)},Terminal.prototype.resetMode=function(params){if("object"==typeof params)for(var l=params.length,i=0;i<l;i++)this.resetMode(params[i]);else if(this.prefix){if("?"===this.prefix)switch(params){case 1:this.applicationCursor=!1;break;case 3:132===this.cols&&this.savedCols&&this.resize(this.savedCols,this.rows),delete this.savedCols;break;case 6:this.originMode=!1;break;case 7:this.wraparoundMode=!1;break;case 12:break;case 66:this.log("Switching back to normal keypad."),this.applicationKeypad=!1;break;case 9:case 1e3:case 1002:case 1003:this.x10Mouse=!1,this.vt200Mouse=!1,this.normalMouse=!1,this.mouseEvents=!1,this.element.style.cursor="";break;case 1004:this.sendFocus=!1;break;case 1005:this.utfMouse=!1;break;case 1006:this.sgrMouse=!1;break;case 1015:this.urxvtMouse=!1;break;case 25:this.cursorHidden=!0;break;case 1049:case 47:case 1047:this.normal&&(this.lines=this.normal.lines,this.ybase=this.normal.ybase,this.ydisp=this.normal.ydisp,this.x=this.normal.x,this.y=this.normal.y,this.scrollTop=this.normal.scrollTop,this.scrollBottom=this.normal.scrollBottom,this.tabs=this.normal.tabs,this.normal=null,this.refresh(0,this.rows-1),this.showCursor())}}else 4===params&&(this.insertMode=!1)},Terminal.prototype.setScrollRegion=function(params){this.prefix||(this.scrollTop=(params[0]||1)-1,this.scrollBottom=(params[1]||this.rows)-1,this.x=0,this.y=0)},Terminal.prototype.saveCursor=function(params){this.savedX=this.x,this.savedY=this.y},Terminal.prototype.restoreCursor=function(params){this.x=this.savedX||0,this.y=this.savedY||0},Terminal.prototype.cursorForwardTab=function(params){for(var param=params[0]||1;param--;)this.x=this.nextStop()},Terminal.prototype.scrollUp=function(params){for(var param=params[0]||1;param--;)this.lines.splice(this.ybase+this.scrollTop,1),this.lines.splice(this.ybase+this.scrollBottom,0,this.blankLine());this.updateRange(this.scrollTop),this.updateRange(this.scrollBottom)},Terminal.prototype.scrollDown=function(params){for(var param=params[0]||1;param--;)this.lines.splice(this.ybase+this.scrollBottom,1),this.lines.splice(this.ybase+this.scrollTop,0,this.blankLine());this.updateRange(this.scrollTop),this.updateRange(this.scrollBottom)},Terminal.prototype.initMouseTracking=function(params){},Terminal.prototype.resetTitleModes=function(params){},Terminal.prototype.cursorBackwardTab=function(params){for(var param=params[0]||1;param--;)this.x=this.prevStop()},Terminal.prototype.repeatPrecedingCharacter=function(params){for(var param=params[0]||1,line=this.lines[this.ybase+this.y],ch=line[this.x-1]||[this.defAttr," "];param--;)line[this.x++]=ch},Terminal.prototype.tabClear=function(params){params=params[0];params<=0?delete this.tabs[this.x]:3===params&&(this.tabs={})},Terminal.prototype.mediaCopy=function(params){},Terminal.prototype.setResources=function(params){},Terminal.prototype.disableModifiers=function(params){},Terminal.prototype.setPointerMode=function(params){},Terminal.prototype.softReset=function(params){this.cursorHidden=!1,this.insertMode=!1,this.originMode=!1,this.wraparoundMode=!1,this.applicationKeypad=!1,this.applicationCursor=!1,this.scrollTop=0,this.scrollBottom=this.rows-1,this.curAttr=this.defAttr,this.x=this.y=0,this.charset=null,this.glevel=0,this.charsets=[null]},Terminal.prototype.requestAnsiMode=function(params){},Terminal.prototype.requestPrivateMode=function(params){},Terminal.prototype.setConformanceLevel=function(params){},Terminal.prototype.loadLEDs=function(params){},Terminal.prototype.setCursorStyle=function(params){},Terminal.prototype.setCharProtectionAttr=function(params){},Terminal.prototype.restorePrivateValues=function(params){},Terminal.prototype.setAttrInRectangle=function(params){for(var line,i,t=params[0],l=params[1],b=params[2],r=params[3],attr=params[4];t<b+1;t++)for(line=this.lines[this.ybase+t],i=l;i<r;i++)line[i]=[attr,line[i][1]];this.updateRange(params[0]),this.updateRange(params[2])},Terminal.prototype.savePrivateValues=function(params){},Terminal.prototype.manipulateWindow=function(params){},Terminal.prototype.reverseAttrInRectangle=function(params){},Terminal.prototype.setTitleModeFeature=function(params){},Terminal.prototype.setWarningBellVolume=function(params){},Terminal.prototype.setMarginBellVolume=function(params){},Terminal.prototype.copyRectangle=function(params){},Terminal.prototype.enableFilterRectangle=function(params){},Terminal.prototype.requestParameters=function(params){},Terminal.prototype.selectChangeExtent=function(params){},Terminal.prototype.fillRectangle=function(params){for(var line,i,ch=params[0],t=params[1],l=params[2],b=params[3],r=params[4];t<b+1;t++)for(line=this.lines[this.ybase+t],i=l;i<r;i++)line[i]=[line[i][0],String.fromCharCode(ch)];this.updateRange(params[1]),this.updateRange(params[3])},Terminal.prototype.enableLocatorReporting=function(params){params[0]},Terminal.prototype.eraseRectangle=function(params){for(var line,i,t=params[0],l=params[1],b=params[2],r=params[3],ch=[this.eraseAttr()," "];t<b+1;t++)for(line=this.lines[this.ybase+t],i=l;i<r;i++)line[i]=ch;this.updateRange(params[0]),this.updateRange(params[2])},Terminal.prototype.setLocatorEvents=function(params){},Terminal.prototype.selectiveEraseRectangle=function(params){},Terminal.prototype.requestLocatorPosition=function(params){},Terminal.prototype.insertColumns=function(){for(var i,param=params[0],l=this.ybase+this.rows,ch=[this.eraseAttr()," "];param--;)for(i=this.ybase;i<l;i++)this.lines[i].splice(this.x+1,0,ch),this.lines[i].pop();this.maxRange()},Terminal.prototype.deleteColumns=function(){for(var i,param=params[0],l=this.ybase+this.rows,ch=[this.eraseAttr()," "];param--;)for(i=this.ybase;i<l;i++)this.lines[i].splice(this.x,1),this.lines[i].push(ch);this.maxRange()},Terminal.prototype.enterPrefix=function(){this.prefixMode=!0},Terminal.prototype.leavePrefix=function(){this.prefixMode=!1},Terminal.prototype.enterSelect=function(){this._real={x:this.x,y:this.y,ydisp:this.ydisp,ybase:this.ybase,cursorHidden:this.cursorHidden,lines:this.copyBuffer(this.lines),write:this.write},this.write=function(){},this.selectMode=!0,this.visualMode=!1,this.cursorHidden=!1,this.refresh(this.y,this.y)},Terminal.prototype.leaveSelect=function(){this.x=this._real.x,this.y=this._real.y,this.ydisp=this._real.ydisp,this.ybase=this._real.ybase,this.cursorHidden=this._real.cursorHidden,this.lines=this._real.lines,this.write=this._real.write,delete this._real,this.selectMode=!1,this.visualMode=!1,this.refresh(0,this.rows-1)},Terminal.prototype.enterVisual=function(){this._real.preVisual=this.copyBuffer(this.lines),this.selectText(this.x,this.x,this.ydisp+this.y,this.ydisp+this.y),this.visualMode=!0},Terminal.prototype.leaveVisual=function(){this.lines=this._real.preVisual,delete this._real.preVisual,delete this._selected,this.visualMode=!1,this.refresh(0,this.rows-1)},Terminal.prototype.enterSearch=function(down){this.entry="",this.searchMode=!0,this.searchDown=down,this._real.preSearch=this.copyBuffer(this.lines),this._real.preSearchX=this.x,this._real.preSearchY=this.y;for(var bottom=this.ydisp+this.rows-1,i=0;i<this.entryPrefix.length;i++)this.lines[bottom][i]=[-512&this.defAttr|4,this.entryPrefix[i]];this.y=this.rows-1,this.x=this.entryPrefix.length,this.refresh(this.rows-1,this.rows-1)},Terminal.prototype.leaveSearch=function(){this.searchMode=!1,this._real.preSearch&&(this.lines=this._real.preSearch,this.x=this._real.preSearchX,this.y=this._real.preSearchY,delete this._real.preSearch,delete this._real.preSearchX,delete this._real.preSearchY),this.refresh(this.rows-1,this.rows-1)},Terminal.prototype.copyBuffer=function(lines){for(var lines=lines||this.lines,out=[],y=0;y<lines.length;y++){out[y]=[];for(var x=0;x<lines[y].length;x++)out[y][x]=[lines[y][x][0],lines[y][x][1]]}return out},Terminal.prototype.getCopyTextarea=function(text){var textarea=this._copyTextarea,document=this.document;return textarea||((textarea=document.createElement("textarea")).style.position="absolute",textarea.style.left="-32000px",textarea.style.top="-32000px",textarea.style.width="0px",textarea.style.height="0px",textarea.style.opacity="0",textarea.style.backgroundColor="transparent",textarea.style.borderStyle="none",textarea.style.outlineStyle="none",document.getElementsByTagName("body")[0].appendChild(textarea),this._copyTextarea=textarea),textarea},Terminal.prototype.copyText=function(text){var self=this,textarea=this.getCopyTextarea();this.emit("copy",text),textarea.focus(),textarea.textContent=text,textarea.value=text,textarea.setSelectionRange(0,text.length),setTimeout(function(){self.element.focus(),self.focus()},1)},Terminal.prototype.selectText=function(x1,x2,y1,y2){var ox1,ox2,oy1,oy2,tmp,x,y,xl,attr;if(this._selected){for(ox1=this._selected.x1,ox2=this._selected.x2,oy1=this._selected.y1,(oy2=this._selected.y2)<oy1&&(tmp=ox2,ox2=ox1,ox1=tmp,tmp=oy2,oy2=oy1,oy1=tmp),ox2<ox1&&oy1===oy2&&(tmp=ox2,ox2=ox1,ox1=tmp),y=oy1;y<=oy2;y++)for(x=0,xl=this.cols-1,y===oy1&&(x=ox1),y===oy2&&(xl=ox2);x<=xl;x++)null!=this.lines[y][x].old&&(attr=this.lines[y][x].old,delete this.lines[y][x].old,this.lines[y][x]=[attr,this.lines[y][x][1]]);y1=this._selected.y1,x1=this._selected.x1}for(y1=Math.max(y1,0),y1=Math.min(y1,this.ydisp+this.rows-1),y2=Math.max(y2,0),y2=Math.min(y2,this.ydisp+this.rows-1),this._selected={x1:x1,x2:x2,y1:y1,y2:y2},y2<y1&&(tmp=x2,x2=x1,x1=tmp,tmp=y2,y2=y1,y1=tmp),x2<x1&&y1===y2&&(tmp=x2,x2=x1,x1=tmp),y=y1;y<=y2;y++)for(x=0,xl=this.cols-1,y===y1&&(x=x1),y===y2&&(xl=x2);x<=xl;x++)attr=this.lines[y][x][0],this.lines[y][x]=[-512&attr|261636,this.lines[y][x][1]],this.lines[y][x].old=attr;y1-=this.ydisp,y2-=this.ydisp,y1=Math.max(y1,0),y1=Math.min(y1,this.rows-1),y2=Math.max(y2,0),y2=Math.min(y2,this.rows-1),this.refresh(0,this.rows-1)},Terminal.prototype.grabText=function(x1,x2,y1,y2){var ch,x,y,xl,tmp,out="",buf="";for(y2<y1&&(tmp=x2,x2=x1,x1=tmp,tmp=y2,y2=y1,y1=tmp),x2<x1&&y1===y2&&(tmp=x2,x2=x1,x1=tmp),y=y1;y<=y2;y++){for(x=0,xl=this.cols-1,y===y1&&(x=x1),y===y2&&(xl=x2);x<=xl;x++)" "===(ch=this.lines[y][x][1])?buf+=ch:(buf&&(out+=buf,buf=""),out+=ch,isWide(ch)&&x++);buf="",out+="\n"}for(x=x2,y=y2;x<this.cols;x++)if(" "!==this.lines[y][x][1]){out=out.slice(0,-1);break}return out},Terminal.prototype.keyPrefix=function(ev,key){"k"===key||"&"===key?this.destroy():"p"===key||"]"===key?this.emit("request paste"):"c"===key?this.emit("request create"):"0"<=key&&key<="9"?this.emit("request term",key=~(key=+key-1)?key:9):"n"===key?this.emit("request term next"):"P"===key?this.emit("request term previous"):":"===key?this.emit("request command mode"):"["===key&&this.enterSelect()},Terminal.prototype.keySelect=function(ev,key){if(this.showCursor(),this.searchMode||"n"===key||"N"===key)return this.keySearch(ev,key);if(""===key)y=this.ydisp+this.y,this.ydisp===this.ybase?(this.y=Math.min(this.y+(this.rows-1)/2|0,this.rows-1),this.refresh(0,this.rows-1)):this.scrollDisp((this.rows-1)/2|0),this.visualMode&&this.selectText(this.x,this.x,y,this.ydisp+this.y);else if(""===key)y=this.ydisp+this.y,0===this.ydisp?(this.y=Math.max(this.y-(this.rows-1)/2|0,0),this.refresh(0,this.rows-1)):this.scrollDisp(-(this.rows-1)/2|0),this.visualMode&&this.selectText(this.x,this.x,y,this.ydisp+this.y);else if(""===key)y=this.ydisp+this.y,this.scrollDisp(this.rows-1),this.visualMode&&this.selectText(this.x,this.x,y,this.ydisp+this.y);else if(""===key)y=this.ydisp+this.y,this.scrollDisp(-(this.rows-1)),this.visualMode&&this.selectText(this.x,this.x,y,this.ydisp+this.y);else if("k"===key||"[A"===key)y=this.ydisp+this.y,this.y--,this.y<0&&(this.y=0,this.scrollDisp(-1)),this.visualMode?this.selectText(this.x,this.x,y,this.ydisp+this.y):this.refresh(this.y,this.y+1);else if("j"===key||"[B"===key)y=this.ydisp+this.y,this.y++,this.y>=this.rows&&(this.y=this.rows-1,this.scrollDisp(1)),this.visualMode?this.selectText(this.x,this.x,y,this.ydisp+this.y):this.refresh(this.y-1,this.y);else if("h"===key||"[D"===key)x=this.x,this.x--,this.x<0&&(this.x=0),this.visualMode?this.selectText(x,this.x,this.ydisp+this.y,this.ydisp+this.y):this.refresh(this.y,this.y);else if("l"===key||"[C"===key)x=this.x,this.x++,this.x>=this.cols&&(this.x=this.cols-1),this.visualMode?this.selectText(x,this.x,this.ydisp+this.y,this.ydisp+this.y):this.refresh(this.y,this.y);else if("v"===key||" "===key)this.visualMode?this.leaveVisual():this.enterVisual();else if("y"===key)this.visualMode&&(ev=this.grabText(this._selected.x1,this._selected.x2,this._selected.y1,this._selected.y2),this.copyText(ev),this.leaveVisual());else if("q"===key||""===key)this.visualMode?this.leaveVisual():this.leaveSelect();else if("w"===key||"W"===key){for(var ox=this.x,oy=this.y,oyd=this.ydisp,x=this.x,y=this.y,yb=this.ydisp,saw_space=!1;;){for(var line=this.lines[yb+y];x<this.cols;){if(line[x][1]<=" ")saw_space=!0;else if(saw_space)break;x++}if(!((x=x>=this.cols?this.cols-1:x)===this.cols-1&&line[x][1]<=" "))break;if(x=0,++y>=this.rows&&(y--,++yb>this.ybase)){yb=this.ybase,x=this.x;break}}this.x=x,this.y=y,this.scrollDisp(-this.ydisp+yb),this.visualMode&&this.selectText(ox,this.x,oy+oyd,this.ydisp+this.y)}else if("b"===key||"B"===key){for(var ox=this.x,oy=this.y,oyd=this.ydisp,x=this.x,y=this.y,yb=this.ydisp;;){for(line=this.lines[yb+y],saw_space=0<x&&" "<line[x][1]&&" "<line[x-1][1];0<=x;){if(line[x][1]<=" "){if(saw_space&&x+1<this.cols&&" "<line[x+1][1]){x++;break}saw_space=!0}x--}if(0!==(x=x<0?0:x)||!(line[x][1]<=" ")&&saw_space)break;if(x=this.cols-1,--y<0&&(y++,--yb<0)){yb++,x=0;break}}this.x=x,this.y=y,this.scrollDisp(-this.ydisp+yb),this.visualMode&&this.selectText(ox,this.x,oy+oyd,this.ydisp+this.y)}else if("e"===key||"E"===key){x=this.x+1,y=this.y,yb=this.ydisp;for(x>=this.cols&&x--;;){for(line=this.lines[yb+y];x<this.cols&&line[x][1]<=" ";)x++;for(;x<this.cols;){if(line[x][1]<=" "&&0<=x-1&&" "<line[x-1][1]){x--;break}x++}if(!((x=x>=this.cols?this.cols-1:x)===this.cols-1&&line[x][1]<=" "))break;if(x=0,++y>=this.rows&&(y--,++yb>this.ybase)){yb=this.ybase;break}}this.x=x,this.y=y,this.scrollDisp(-this.ydisp+yb),this.visualMode&&this.selectText(ox,this.x,oy+oyd,this.ydisp+this.y)}else if("^"===key||"0"===key){var ox=this.x;if("0"===key)this.x=0;else if("^"===key){for(line=this.lines[this.ydisp+this.y],x=0;x<this.cols&&!(" "<line[x][1]);)x++;x>=this.cols&&(x=this.cols-1),this.x=x}this.visualMode?this.selectText(ox,this.x,this.ydisp+this.y,this.ydisp+this.y):this.refresh(this.y,this.y)}else if("$"===key){for(ox=this.x,line=this.lines[this.ydisp+this.y],x=this.cols-1;0<=x;){if(" "<line[x][1]){this.visualMode&&x<this.cols-1&&x++;break}x--}this.x=x=x<0?0:x,this.visualMode?this.selectText(ox,this.x,this.ydisp+this.y,this.ydisp+this.y):this.refresh(this.y,this.y)}else if("g"===key||"G"===key)ox=this.x,oy=this.y,oyd=this.ydisp,"g"===key?(this.x=0,this.y=0,this.scrollDisp(-this.ydisp)):"G"===key&&(this.x=0,this.y=this.rows-1,this.scrollDisp(this.ybase)),this.visualMode&&this.selectText(ox,this.x,oy+oyd,this.ydisp+this.y);else if("H"===key||"M"===key||"L"===key)ox=this.x,oy=this.y,"H"===key?(this.x=0,this.y=0):"M"===key?(this.x=0,this.y=this.rows/2|0):"L"===key&&(this.x=0,this.y=this.rows-1),this.visualMode?this.selectText(ox,this.x,this.ydisp+oy,this.ydisp+this.y):(this.refresh(oy,oy),this.refresh(this.y,this.y));else if("{"===key||"}"===key){var i,ox=this.x,oy=this.y,oyd=this.ydisp,saw_full=!1,found=!1,first_is_space=-1,y=this.y+("{"===key?-1:1),yb=this.ydisp;for("{"===key?y<0&&(y++,0<yb&&yb--):"}"===key&&y>=this.rows&&(y--,yb<this.ybase&&yb++);;){for(line=this.lines[yb+y],i=0;i<this.cols;i++){if(" "<line[i][1]){-1===first_is_space&&(first_is_space=0),saw_full=!0;break}if(i===this.cols-1){-1===first_is_space?first_is_space=1:(0===first_is_space||1===first_is_space&&saw_full)&&(found=!0);break}}if(found)break;if("{"===key){if(--y<0){if(y++,!(0<yb))break;yb--}}else if("}"===key&&++y>=this.rows){if(y--,!(yb<this.ybase))break;yb++}}found||("{"===key?yb=y=0:"}"===key&&(y=this.rows-1,yb=this.ybase)),this.x=0,this.y=y,this.scrollDisp(-this.ydisp+yb),this.visualMode&&this.selectText(ox,this.x,oy+oyd,this.ydisp+this.y)}else{if("/"!==key&&"?"!==key)return!1;this.visualMode||this.enterSearch("/"===key)}},Terminal.prototype.keySearch=function(ev,key){if(""===key)this.leaveSearch();else{if("\r"!==key&&(this.searchMode||"n"!==key&&"N"!==key))return"\b"===key||""===key?0===this.entry.length?void 0:(bottom=this.ydisp+this.rows-1,this.entry=this.entry.slice(0,-1),i=this.entryPrefix.length+this.entry.length,this.lines[bottom][i]=[this.lines[bottom][i][0]," "],this.x--,this.refresh(this.rows-1,this.rows-1),void this.refresh(this.y,this.y)):1===key.length&&" "<=key&&key<="~"&&(bottom=this.ydisp+this.rows-1,this.entry+=key,i=this.entryPrefix.length+this.entry.length-1,this.lines[bottom][i]=[-512&this.defAttr|4,key],this.x++,this.refresh(this.rows-1,this.rows-1),void this.refresh(this.y,this.y));this.leaveSearch();var entry=this.entry;if(entry){for(var line,yb,i,bottom=this.x,oy=this.y,oyd=this.ydisp,found=!1,wrapped=!1,x=this.x+1,y=this.ydisp+this.y,up="N"===key?this.searchDown:!this.searchDown;;){for(line=this.lines[y];x<this.cols;){for(i=0;i<entry.length&&!(x+i>=this.cols)&&line[x+i][1]===entry[i];i++)if(line[x+i][1]===entry[i]&&i===entry.length-1){found=!0;break}if(found)break;x+=i+1}if(found)break;if(x=0,up){if(--y<0){if(wrapped)break;wrapped=!0,y=this.ybase+this.rows-1}}else if(++y>this.ybase+this.rows-1){if(wrapped)break;wrapped=!0,y=0}}return found?(y-this.ybase<0?(yb=y,y=0,yb>this.ybase&&(y=yb-this.ybase,yb=this.ybase)):(yb=this.ybase,y-=this.ybase),this.x=x,this.y=y,this.scrollDisp(-this.ydisp+yb),void(this.visualMode&&this.selectText(bottom,this.x,oy+oyd,this.ydisp+this.y))):void this.refresh(0,this.rows-1)}this.refresh(0,this.rows-1)}},Terminal.charsets={},Terminal.charsets.SCLD={"`":"◆",a:"▒",b:"\t",c:"\f",d:"\r",e:"\n",f:"°",g:"±",h:"␤",i:"\v",j:"┘",k:"┐",l:"┌",m:"└",n:"┼",o:"⎺",p:"⎻",q:"─",r:"⎼",s:"⎽",t:"├",u:"┤",v:"┴",w:"┬",x:"│",y:"≤",z:"≥","{":"π","|":"≠","}":"£","~":"·"},Terminal.charsets.UK=null,Terminal.charsets.US=null,Terminal.charsets.Dutch=null,Terminal.charsets.Finnish=null,Terminal.charsets.French=null,Terminal.charsets.FrenchCanadian=null,Terminal.charsets.German=null,Terminal.charsets.Italian=null,Terminal.charsets.NorwegianDanish=null,Terminal.charsets.Spanish=null,Terminal.charsets.Swedish=null,Terminal.charsets.Swiss=null,Terminal.charsets.ISOLatin=null;var String=this.String,setTimeout=this.setTimeout,setInterval=this.setInterval;function isWide(ch){return!(ch<="＀")&&("！"<=ch&&ch<="ﾾ"||"ￂ"<=ch&&ch<="ￇ"||"ￊ"<=ch&&ch<="ￏ"||"ￒ"<=ch&&ch<="ￗ"||"ￚ"<=ch&&ch<="ￜ"||"￠"<=ch&&ch<="￦"||"￨"<=ch&&ch<="￮")}function matchColor(r1,g1,b1){var hash=r1<<16|g1<<8|b1;if(null!=matchColor._cache[hash])return matchColor._cache[hash];for(var g2,c,r2,ldiff=1/0,li=-1,i=0;i<Terminal.vcolors.length;i++){if(r2=(c=Terminal.vcolors[i])[0],g2=c[1],c=c[2],0===(r2=matchColor.distance(r1,g1,b1,r2,g2,c))){li=i;break}r2<ldiff&&(ldiff=r2,li=i)}return matchColor._cache[hash]=li}function each(obj,iter,con){if(obj.forEach)return obj.forEach(iter,con);for(var i=0;i<obj.length;i++)iter.call(con,obj[i],i,obj)}function keys(obj){if(Object.keys)return Object.keys(obj);var key,keys=[];for(key in obj)Object.prototype.hasOwnProperty.call(obj,key)&&keys.push(key);return keys}matchColor._cache={},matchColor.distance=function(r1,g1,b1,r2,g2,b2){return Math.pow(30*(r1-r2),2)+Math.pow(59*(g1-g2),2)+Math.pow(11*(b1-b2),2)},Terminal.EventEmitter=EventEmitter,Terminal.Stream=Stream,Terminal.inherits=inherits,Terminal.on=on,Terminal.off=off,Terminal.cancel=cancel,"undefined"!=typeof module?module.exports=Terminal:this.Terminal=Terminal}.call(function(){return this||("undefined"!=typeof window?window:global)}());
